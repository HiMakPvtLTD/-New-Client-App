"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[349],{8193:(Z,f,c)=>{c.d(f,{Z:()=>y});var e=c(9468),t=c(6814),C=c(7818),v=c(8351),u=c(3946),b=c(95);function M(D,T){if(1&D){const o=e.EpF();e.TgZ(0,"span",18),e.NdJ("mouseenter",function(){const p=e.CHM(o).$implicit,h=e.oxw();return e.KtG(h.hoveredDate=p)})("mouseleave",function(){e.CHM(o);const l=e.oxw();return e.KtG(l.hoveredDate=null)}),e._uU(1),e.qZA()}if(2&D){const o=T.$implicit,m=T.focused,l=e.oxw();e.ekj("focused",m)("range",l.isRange(o))("faded",l.isHovered(o)||l.isInside(o)),e.xp6(1),e.hij(" ",o.day," ")}}let y=(()=>{class D{constructor(o){this.activeModal=o,this.calendar=(0,e.f3M)(u.vL),this.hoveredDate=null,this.fromDate=this.calendar.getToday(),this.toDate=this.calendar.getNext(this.fromDate,"d",-1),this.currentDate=new Date,this.startTime={hour:this.currentDate.getHours(),minute:this.currentDate.getMinutes()},this.endTime={hour:this.currentDate.getHours(),minute:this.currentDate.getMinutes()}}ngOnInit(){const o=this.inputData.startDate,m=this.inputData.endDate;this.fromDate={year:o.getFullYear(),month:o.getMonth()+1,day:o.getDate()},this.toDate={year:m.getFullYear(),month:m.getMonth()+1,day:m.getDate()};const l=o.getHours(),p=o.getMinutes(),h=m.getHours(),x=m.getMinutes();this.startTime={hour:l,minute:p},this.endTime={hour:h,minute:x}}onDateSelection(o){this.fromDate||this.toDate?this.fromDate&&!this.toDate&&o.after(this.fromDate)?this.toDate=o:(this.toDate=null,this.fromDate=o):this.fromDate=o}isHovered(o){return this.fromDate&&!this.toDate&&this.hoveredDate&&o.after(this.fromDate)&&o.before(this.hoveredDate)}isInside(o){return this.toDate&&o.after(this.fromDate)&&o.before(this.toDate)}isRange(o){return o.equals(this.fromDate)||this.toDate&&o.equals(this.toDate)||this.isInside(o)||this.isHovered(o)}selectDataAndClose(){this.activeModal.close({isUpdated:!0,dateData:{startDate:this.fromDate,endDate:this.toDate,startTime:this.startTime,endTime:this.endTime}})}closeModal(){this.activeModal.dismiss({isUpdated:!1})}static#t=this.\u0275fac=function(m){return new(m||D)(e.Y36(u.Kz))};static#e=this.\u0275cmp=e.Xpm({type:D,selectors:[["app-datatime-range-modal"]],inputs:{inputData:"inputData"},standalone:!0,features:[e.jDz],decls:26,vars:4,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row"],["outsideDays","hidden",1,"range-datetimepicker",3,"displayMonths","dayTemplate","dateSelect"],["dp",""],["t",""],[1,"col-md-6","col-sm-6"],[3,"ngModel","ngModelChange"],[1,"row","justify-content-end"],[1,"col-xl-3","col-md-3","col-sm-6"],["type","button","ngbAutofocus","",1,"btn","btn-block","btn-primary","mb-4",3,"click"],[1,"fas","fa-check"],[1,"col-xl-4","col-md-3","col-sm-6"],["type","button",1,"btn","btn-block","btn-primary","mb-4",3,"click"],[1,"fas","fa-times"],[1,"custom-day",3,"mouseenter","mouseleave"]],template:function(m,l){if(1&m&&(e.TgZ(0,"div",0)(1,"h6",1),e._uU(2,"Select Date"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return l.closeModal()}),e.TgZ(4,"span",3),e._uU(5,"\xd7"),e.qZA()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"ngb-datepicker",6,7),e.NdJ("dateSelect",function(h){return l.onDateSelection(h)}),e.qZA(),e.YNc(10,M,2,7,"ng-template",null,8,e.W1O),e.qZA(),e.TgZ(12,"div",5)(13,"div",9)(14,"ngb-timepicker",10),e.NdJ("ngModelChange",function(h){return l.startTime=h}),e.qZA()(),e.TgZ(15,"div",9)(16,"ngb-timepicker",10),e.NdJ("ngModelChange",function(h){return l.endTime=h}),e.qZA()()(),e.TgZ(17,"div",11)(18,"div",12)(19,"button",13),e.NdJ("click",function(){return l.selectDataAndClose()}),e._UZ(20,"i",14),e._uU(21," Apply "),e.qZA()(),e.TgZ(22,"div",15)(23,"button",16),e.NdJ("click",function(){return l.closeModal()}),e._UZ(24,"i",17),e._uU(25," Cancel "),e.qZA()()()()),2&m){const p=e.MAs(11);e.xp6(8),e.Q6J("displayMonths",2)("dayTemplate",p),e.xp6(6),e.Q6J("ngModel",l.startTime),e.xp6(2),e.Q6J("ngModel",l.endTime)}},dependencies:[t.ez,C.m,b.JJ,b.On,u.VL,u.Pm,v.Qf],styles:[".modal-title{font-style:normal;font-weight:400}  .modal-header{padding:10px}  .close{border-radius:50%;padding:0 8px;border-color:#666}  .modal-row-border{border-color:#ced4da;border-style:solid;border-width:.8px;border-radius:5px;padding:10px;margin:20px 10px}  .ml-10{margin-left:10px}  .mb-5{margin-bottom:5px}  .custom-day{text-align:center;padding:.185rem .25rem;display:inline-block;height:2rem;width:2rem}  .custom-day.focused{background-color:#e6e6e6}  .custom-day.range,   .custom-day:hover{background-color:#0275d8;color:#fff}  .custom-day.faded{background-color:#0275d880}  .range-datetimepicker{overflow-x:scroll}@media only screen and (max-width: 768px){  .col-sm-6{width:50%}}"]})}return D})()},6349:(Z,f,c)=>{c.r(f),c.d(f,{NgbdSortableHeaderDirective:()=>E,default:()=>j});var e=c(6814),t=c(9468),C=c(7818),v=c(8193),u=c(3946),b=c(9074),M=c(589),y=c(7911),D=c(220);function T(s,_){if(1&s&&(t.TgZ(0,"th"),t._uU(1),t.qZA()),2&s){const a=_.$implicit;t.xp6(1),t.Oqu(a)}}function o(s,_){if(1&s&&(t.TgZ(0,"td",12),t._uU(1),t.qZA()),2&s){const a=_.$implicit,n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n[a]||"null"," ")}}function m(s,_){if(1&s&&(t.TgZ(0,"tr"),t.YNc(1,o,2,1,"td",11),t.qZA()),2&s){const a=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",a.displayedColumns)}}function l(s,_){if(1&s&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&s){const a=_.$implicit,n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n[a]||"null"," ")}}function p(s,_){if(1&s&&(t.ynx(0),t.TgZ(1,"tr"),t.YNc(2,l,2,1,"td",8),t.qZA(),t.BQk()),2&s){const a=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",a.tableData)}}function h(s,_){if(1&s){const a=t.EpF();t.TgZ(0,"div",6)(1,"table",7)(2,"thead")(3,"tr"),t.YNc(4,T,2,1,"th",8),t.qZA()(),t.TgZ(5,"tbody"),t.YNc(6,m,2,1,"tr",8),t.qZA(),t.TgZ(7,"tbody"),t.YNc(8,p,3,1,"ng-container",8),t.qZA()(),t.TgZ(9,"div",9)(10,"ngb-pagination",10),t.NdJ("pageChange",function(i){t.CHM(a);const r=t.oxw();return t.KtG(r.page=i)})("pageChange",function(i){t.CHM(a);const r=t.oxw();return t.KtG(r.handlePageChange(i))}),t.qZA()()()}if(2&s){const a=t.oxw();t.xp6(4),t.Q6J("ngForOf",a.displayedColumns),t.xp6(2),t.Q6J("ngForOf",a.tableData),t.xp6(2),t.Q6J("ngForOf",a.tableData),t.xp6(2),t.Q6J("collectionSize",a.tableData.length)("page",a.page)("maxSize",5)("rotate",!0)("ellipses",!0)("boundaryLinks",!0)}}const x={asc:"desc",desc:"","":"asc"};let E=(()=>{class s{constructor(){this.appSortable="",this.direction="",this.sort=new t.vpe}rotate(){this.direction=x[this.direction],this.sort.emit({column:this.appSortable,direction:this.direction})}static#t=this.\u0275fac=function(n){return new(n||s)};static#e=this.\u0275dir=t.lG2({type:s,selectors:[["th","appSortable",""]],hostVars:4,hostBindings:function(n,i){1&n&&t.NdJ("click",function(){return i.rotate()}),2&n&&t.ekj("asc","asc"===i.direction)("desc","desc"===i.direction)},inputs:{appSortable:"appSortable",direction:"direction"},outputs:{sort:"sort"},standalone:!0})}return s})(),j=(()=>{class s{constructor(a,n,i,r){this.modalService=a,this.headerService=n,this.projectService=i,this.toastService=r,this.selectedTableData=[],this.tableData=[],this.tempTableData=[],this.page=1,this.pageSize=10,this.displayedColumns=[],this.status=!1,this.data=[],this.headerService.setHeaderName("Group C Report")}ngOnInit(){this.fromDate=new Date,this.toDate=new Date,this.fromDate.setHours(this.fromDate.getHours()-24),this.formatTimeModalDate()}handlePageChange(a){this.sliceTableData(a)}getData(){this.projectService.getGroupCReport(this.jsStartDate,this.jsEndDate).subscribe(a=>{console.log(a,"data"),this.tableData=a,this.displayedColumns=Object.keys(a[0]),console.log(Object.keys(a[0]),"jhgyufj"),this.sliceTableData(this.page),this.status=!0})}exportToFile(){this.toastService.show({template:"Please wait while we prepare the report!!",classname:"bg-info",delay:5e3}),this.projectService.getAmbientReport(this.jsStartDate,this.jsEndDate,this.data).subscribe(a=>{const n=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),i=document.createElement("a");if(n.size>5){i.href=window.URL.createObjectURL(n);const r=new Date,g=`NPD-EnvironmentReport ${r.getDate()}-${r.getMonth()+1}-${r.getFullYear()}`;i.download=`${g}.xlsx`,document.body.appendChild(i),i.click(),document.body.removeChild(i)}else this.toastService.show({template:"Something Went Wrong Please Try Again Later !!!",classname:"bg-danger",delay:3e3})})}openDateTimeModal(){const i={startDate:this.fromDate,endDate:this.toDate},r=this.modalService.open(v.Z);r.componentInstance.inputData=i,r.result.then(d=>{const R=new Intl.DateTimeFormat("en-GB",{hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),S=new Date(d.dateData.startDate.year,d.dateData.startDate.month-1,d.dateData.startDate.day,d.dateData.startTime.hour,d.dateData.startTime.minute,0),P=R.format(S),O=new Date(d.dateData.endDate.year,d.dateData.endDate.month-1,d.dateData.endDate.day,d.dateData.endTime.hour,d.dateData.endTime.minute,0),w=R.format(O);this.formattedDateTimeRange=P+" - "+w,this.jsStartDate=S,this.jsEndDate=O,this.jsStartDate=this.formatDate(this.jsStartDate),this.jsEndDate=this.formatDate(this.jsEndDate),this.getData()},d=>{console.log(`Modal dismissed with: ${d}`)})}onSort({column:a,direction:n}){if(this.headers)for(const i of this.headers)i.appSortable!==a&&(i.direction="");""===n||""===a?(this.tableData=this.tempTableData,this.sliceTableData(this.page)):(this.tableData=[...this.tempTableData].sort((i,r)=>{const d=((s,_)=>s<_?-1:s>_?1:0)(i[a],r[a]);return"asc"===n?d:-d}),this.sliceTableData(this.page))}sliceTableData(a){this.selectedTableData=this.tableData.slice((a-1)*this.pageSize,a*this.pageSize)}formatTimeModalDate(){const n=new Intl.DateTimeFormat("en-GB",{hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),r=n.format(this.toDate),g=n.format(this.fromDate);this.jsStartDate=this.formatDate(this.fromDate),this.jsEndDate=this.formatDate(this.toDate),this.formattedDateTimeRange=g+" - "+r}formatDate(a){return`${a.getFullYear()}-${this.padZero(a.getMonth()+1)}-${this.padZero(a.getDate())}T${this.padZero(a.getHours())}:${this.padZero(Math.abs(a.getMinutes()))}`}padZero(a){return a<10?`0${a}`:`${a}`}static#t=this.\u0275fac=function(n){return new(n||s)(t.Y36(u.FF),t.Y36(b.r),t.Y36(M.Y),t.Y36(y.k))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-group-c-report"]],viewQuery:function(n,i){if(1&n&&t.Gf(E,5),2&n){let r;t.iGM(r=t.CRH())&&(i.headers=r)}},standalone:!0,features:[t.jDz],decls:9,vars:4,consts:[[1,"ambient-report","mt-2"],[3,"hidHeader","options"],[1,"d-flex","align-items-start","justify-content-between","dateRangePicker"],[1,"custom-datetime-range-span",3,"click"],[1,"fas","fa-calendar"],["class","table-responsive",4,"ngIf"],[1,"table-responsive"],[1,"table","table-styling"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-end","align-items-center","gap-3"],[3,"collectionSize","page","maxSize","rotate","ellipses","boundaryLinks","pageChange"],["style","width: 200px;",4,"ngFor","ngForOf"],[2,"width","200px"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div")(2,"app-card",1)(3,"div",2)(4,"div")(5,"span",3),t.NdJ("click",function(){return i.openDateTimeModal()}),t._UZ(6,"i",4),t._uU(7),t.qZA()()(),t.YNc(8,h,11,9,"div",5),t.qZA()()()),2&n&&(t.xp6(2),t.Q6J("hidHeader",!0)("options",!1),t.xp6(5),t.hij(" ",i.formattedDateTimeRange," "),t.xp6(1),t.Q6J("ngIf",i.tableData&&i.tableData.length))},dependencies:[e.ez,e.sg,e.O5,C.m,D.A,u.N9],styles:[".custom-datetime-range-span{padding:2px 8px;border:solid 1px rgb(206,212,218);border-radius:20px}  .custom-datetime-range-span i{margin-right:15px}  .card .card-body{padding:10px 8px!important}  .btn-apply{padding:2px 8px!important;margin-left:5px}  th{width:100px}"]})}return s})()}}]);