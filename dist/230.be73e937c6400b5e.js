"use strict";(self.webpackChunkskeleton=self.webpackChunkskeleton||[]).push([[230],{8193:(y,S,c)=>{c.d(S,{Z:()=>m});var i=c(9468),t=c(6814),Z=c(7818),A=c(8351),b=c(3946),M=c(95);function x(T,C){if(1&T){const l=i.EpF();i.TgZ(0,"span",18),i.NdJ("mouseenter",function(){const _=i.CHM(l).$implicit,f=i.oxw();return i.KtG(f.hoveredDate=_)})("mouseleave",function(){i.CHM(l);const p=i.oxw();return i.KtG(p.hoveredDate=null)}),i._uU(1),i.qZA()}if(2&T){const l=C.$implicit,u=C.focused,p=i.oxw();i.ekj("focused",u)("range",p.isRange(l))("faded",p.isHovered(l)||p.isInside(l)),i.xp6(1),i.hij(" ",l.day," ")}}let m=(()=>{class T{constructor(l){this.activeModal=l,this.calendar=(0,i.f3M)(b.vL),this.hoveredDate=null,this.fromDate=this.calendar.getToday(),this.toDate=this.calendar.getNext(this.fromDate,"d",-1),this.currentDate=new Date,this.startTime={hour:this.currentDate.getHours(),minute:this.currentDate.getMinutes()},this.endTime={hour:this.currentDate.getHours(),minute:this.currentDate.getMinutes()}}ngOnInit(){console.log(this.inputData);const l=this.inputData.startDate,u=this.inputData.endDate;this.fromDate={year:l.getFullYear(),month:l.getMonth()+1,day:l.getDate()},this.toDate={year:u.getFullYear(),month:u.getMonth()+1,day:u.getDate()};const p=l.getHours(),_=l.getMinutes(),f=u.getHours(),j=u.getMinutes();this.startTime={hour:p,minute:_},this.endTime={hour:f,minute:j}}onDateSelection(l){this.fromDate||this.toDate?this.fromDate&&!this.toDate&&l.after(this.fromDate)?this.toDate=l:(this.toDate=null,this.fromDate=l):this.fromDate=l}isHovered(l){return this.fromDate&&!this.toDate&&this.hoveredDate&&l.after(this.fromDate)&&l.before(this.hoveredDate)}isInside(l){return this.toDate&&l.after(this.fromDate)&&l.before(this.toDate)}isRange(l){return l.equals(this.fromDate)||this.toDate&&l.equals(this.toDate)||this.isInside(l)||this.isHovered(l)}selectDataAndClose(){this.activeModal.close({isUpdated:!0,dateData:{startDate:this.fromDate,endDate:this.toDate,startTime:this.startTime,endTime:this.endTime}})}closeModal(){this.activeModal.dismiss({isUpdated:!1})}static#t=this.\u0275fac=function(u){return new(u||T)(i.Y36(b.Kz))};static#e=this.\u0275cmp=i.Xpm({type:T,selectors:[["app-datatime-range-modal"]],inputs:{inputData:"inputData"},standalone:!0,features:[i.jDz],decls:26,vars:4,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row"],["outsideDays","hidden",1,"range-datetimepicker",3,"displayMonths","dayTemplate","dateSelect"],["dp",""],["t",""],[1,"col-md-6","col-sm-6"],[3,"ngModel","ngModelChange"],[1,"row","justify-content-end"],[1,"col-xl-3","col-md-3","col-sm-6"],["type","button","ngbAutofocus","",1,"btn","btn-block","btn-primary","mb-4",3,"click"],[1,"fas","fa-check"],[1,"col-xl-4","col-md-3","col-sm-6"],["type","button",1,"btn","btn-block","btn-primary","mb-4",3,"click"],[1,"fas","fa-times"],[1,"custom-day",3,"mouseenter","mouseleave"]],template:function(u,p){if(1&u&&(i.TgZ(0,"div",0)(1,"h6",1),i._uU(2,"Select Date"),i.qZA(),i.TgZ(3,"button",2),i.NdJ("click",function(){return p.closeModal()}),i.TgZ(4,"span",3),i._uU(5,"\xd7"),i.qZA()()(),i.TgZ(6,"div",4)(7,"div",5)(8,"ngb-datepicker",6,7),i.NdJ("dateSelect",function(f){return p.onDateSelection(f)}),i.qZA(),i.YNc(10,x,2,7,"ng-template",null,8,i.W1O),i.qZA(),i.TgZ(12,"div",5)(13,"div",9)(14,"ngb-timepicker",10),i.NdJ("ngModelChange",function(f){return p.startTime=f}),i.qZA()(),i.TgZ(15,"div",9)(16,"ngb-timepicker",10),i.NdJ("ngModelChange",function(f){return p.endTime=f}),i.qZA()()(),i.TgZ(17,"div",11)(18,"div",12)(19,"button",13),i.NdJ("click",function(){return p.selectDataAndClose()}),i._UZ(20,"i",14),i._uU(21," Apply "),i.qZA()(),i.TgZ(22,"div",15)(23,"button",16),i.NdJ("click",function(){return p.closeModal()}),i._UZ(24,"i",17),i._uU(25," Cancel "),i.qZA()()()()),2&u){const _=i.MAs(11);i.xp6(8),i.Q6J("displayMonths",2)("dayTemplate",_),i.xp6(6),i.Q6J("ngModel",p.startTime),i.xp6(2),i.Q6J("ngModel",p.endTime)}},dependencies:[t.ez,Z.m,M.JJ,M.On,b.VL,b.Pm,A.Qf],styles:[".modal-title{font-style:normal;font-weight:400}  .modal-header{padding:10px}  .close{border-radius:50%;padding:0 8px;border-color:#666}  .modal-row-border{border-color:#ced4da;border-style:solid;border-width:.8px;border-radius:5px;padding:10px;margin:20px 10px}  .ml-10{margin-left:10px}  .mb-5{margin-bottom:5px}  .custom-day{text-align:center;padding:.185rem .25rem;display:inline-block;height:2rem;width:2rem}  .custom-day.focused{background-color:#e6e6e6}  .custom-day.range,   .custom-day:hover{background-color:#0275d8;color:#fff}  .custom-day.faded{background-color:#0275d880}  .range-datetimepicker{overflow-x:scroll}@media only screen and (max-width: 768px){  .col-sm-6{width:50%}}"]})}return T})()},3230:(y,S,c)=>{c.r(S),c.d(S,{NgbdSortableHeaderDirective:()=>R,default:()=>V});var i=c(6814),t=c(9468),Z=c(7818),A=c(8193),b=c(3946),M=c(589),x=c(7911),m=c(95);let T=(()=>{class r{constructor(e,n,o){this.activeModal=e,this.projectService=n,this.toastService=o,this.headers=[],this.value=[]}testSubmit(){this.headers=[],this.value=[];var e=[];const a=this.inputData.xcldata.filter(g=>g.ProjectId==this.inputData.projectId);e=[a[0].ProjectName,a[0].ProjectOwner,a[0].ProjectNo,a[0].ProjectId,a[0].Group,a[0].ProjectType,a[0].TestNo,a[0].ProjectConfig,a[0].StartDateTime,a[0].EndDateTime,a[0].differnce],this.headers=Object.keys(a[0]);let s=[];s=[this.buName,this.productName,this.productSize,this.remarks],e=e.concat(s),this.value=e,this.headers=this.headers.concat(["BU Name","ProductName","Product Size","Remarks"]),this.toastService.show({template:"Please wait while we prepare the report!!",classname:"bg-info",delay:5e3}),this.projectService.getAttach(this.inputData.projectId,this.headers,this.value,this.inputData.testset,this.inputData.fromDate,this.inputData.toDate).subscribe(g=>{const D=new Blob([g],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),v=document.createElement("a");if(D.size>5){v.href=window.URL.createObjectURL(D);const P=new Date,K=`NPD-ProjectReport ${P.getDate()}-${P.getMonth()+1}-${P.getFullYear()}`;v.download=`${K}.xlsx`,document.body.appendChild(v),v.click(),document.body.removeChild(v)}else this.toastService.show({template:"Something Went Wrong . Please Try Again Later !!!",classname:"bg-danger",delay:5e3})})}selectDataAndClose(){this.testSubmit(),this.activeModal.close({isSearch:!0,data:"successs"})}closeModal(){this.activeModal.dismiss({isSearch:!1})}static#t=this.\u0275fac=function(n){return new(n||r)(t.Y36(b.Kz),t.Y36(M.Y),t.Y36(x.k))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-report-export-modal"]],inputs:{inputData:"inputData"},decls:34,vars:4,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row"],[1,"form-group"],["for",""],["type","text","name","buName",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","productName",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","productSize",1,"form-control",3,"ngModel","ngModelChange"],["name","remark",1,"form-control",3,"ngModel","ngModelChange"],[1,"row","justify-content-end"],[1,"col-xl-2","col-md-2","px-0"],["type","button","ngbAutofocus","",1,"btn","btn-block","btn-primary","mb-4","custom-btn",3,"click"],[1,"fas","fa-check"],[1,"col-xl-2","col-md-2"],["type","button",1,"btn","btn-block","btn-primary","mb-4","custom-btn",3,"click"],[1,"fas","fa-times"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"h6",1),t._uU(2,"Extra Fields"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return o.closeModal()}),t.TgZ(4,"span",3),t._uU(5,"\xd7"),t.qZA()()(),t.TgZ(6,"div",4)(7,"div",5)(8,"form")(9,"div",6)(10,"label",7),t._uU(11,"BU Name:"),t.qZA(),t.TgZ(12,"input",8),t.NdJ("ngModelChange",function(s){return o.buName=s}),t.qZA()(),t.TgZ(13,"div",6)(14,"label",7),t._uU(15,"Product Name:"),t.qZA(),t.TgZ(16,"input",9),t.NdJ("ngModelChange",function(s){return o.productName=s}),t.qZA()(),t.TgZ(17,"div",6)(18,"label",7),t._uU(19,"Product Size:"),t.qZA(),t.TgZ(20,"input",10),t.NdJ("ngModelChange",function(s){return o.productSize=s}),t.qZA()(),t.TgZ(21,"div",6)(22,"label",7),t._uU(23,"Remarks:"),t.qZA(),t.TgZ(24,"textarea",11),t.NdJ("ngModelChange",function(s){return o.remarks=s}),t.qZA()()()(),t.TgZ(25,"div",12)(26,"div",13)(27,"button",14),t.NdJ("click",function(){return o.selectDataAndClose()}),t._UZ(28,"i",15),t._uU(29," Submit "),t.qZA()(),t.TgZ(30,"div",16)(31,"button",17),t.NdJ("click",function(){return o.closeModal()}),t._UZ(32,"i",18),t._uU(33," Cancel "),t.qZA()()()()),2&n&&(t.xp6(12),t.Q6J("ngModel",o.buName),t.xp6(4),t.Q6J("ngModel",o.productName),t.xp6(4),t.Q6J("ngModel",o.productSize),t.xp6(4),t.Q6J("ngModel",o.remarks))},dependencies:[m._Y,m.Fj,m.JJ,m.JL,m.On,m.F]})}return r})();var C=c(8837),l=c(1486),u=c(9074),p=c(220);function _(r,h){if(1&r&&(t.TgZ(0,"option",26),t._uU(1),t.qZA()),2&r){const e=h.$implicit,n=t.oxw();t.Q6J("value",e)("disabled",n.isDisabledColSelect(e)),t.xp6(1),t.hij("",n.testColumns[e]," ")}}function f(r,h){if(1&r){const e=t.EpF();t.TgZ(0,"div",27),t._uU(1),t.TgZ(2,"span",28),t.NdJ("click",function(){const a=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.removeTag(a))}),t._UZ(3,"i",29),t.qZA()()}if(2&r){const e=h.$implicit,n=t.oxw();t.xp6(1),t.hij(" ",n.testColumns[e]," ")}}const j=function(r){return{selectedRowColor:r}};function N(r,h){if(1&r){const e=t.EpF();t.TgZ(0,"tr",49),t.NdJ("click",function(){const o=t.CHM(e),a=o.$implicit,s=o.index,d=t.oxw(2);return t.KtG(d.handleRowClick(a.ProjectId,s))}),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t._uU(16),t.ALo(17,"date"),t.qZA(),t.TgZ(18,"td"),t._uU(19),t.ALo(20,"date"),t.qZA(),t.TgZ(21,"td"),t._uU(22),t.qZA()()}if(2&r){const e=h.$implicit,n=h.index,o=t.oxw(2);t.Q6J("ngClass",t.VKq(19,j,n===o.selectedRow)),t.xp6(2),t.Oqu(null==e?null:e.ProjectId),t.xp6(2),t.Oqu(null==e?null:e.ProjectName),t.xp6(2),t.Oqu(null==e?null:e.TestBenchNo),t.xp6(2),t.Oqu(null==e?null:e.ProjectType),t.xp6(2),t.Oqu(null==e?null:e.ProjectNo),t.xp6(2),t.Oqu(null==e?null:e.ProjectOwner),t.xp6(2),t.Oqu(null==e?null:e.TestNo),t.xp6(2),t.Oqu(t.Dn7(17,11,null==e?null:e.StartDateTime,"dd/MM/yyyy HH:mm:ss","UTC")),t.xp6(3),t.Oqu(t.Dn7(20,15,null==e?null:e.EndDateTime,"dd/MM/yyyy HH:mm:ss","UTC")),t.xp6(3),t.Oqu(null==e?null:e.differnce)}}function k(r,h){if(1&r){const e=t.EpF();t.TgZ(0,"div")(1,"app-card",30)(2,"div",31)(3,"button",32),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.exportToCSV())}),t._UZ(4,"i",33),t._uU(5," Export "),t.qZA()(),t.TgZ(6,"div",34)(7,"table",35)(8,"thead")(9,"tr")(10,"th",36),t.NdJ("sort",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onSort(o))}),t._uU(11,"Project Id"),t.qZA(),t.TgZ(12,"th",37),t.NdJ("sort",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onSort(o))}),t._uU(13,"Project Name"),t.qZA(),t.TgZ(14,"th",38),t.NdJ("sort",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onSort(o))}),t._uU(15,"Test Bench"),t.qZA(),t.TgZ(16,"th",39),t.NdJ("sort",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onSort(o))}),t._uU(17,"Project Type"),t.qZA(),t.TgZ(18,"th",40),t.NdJ("sort",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onSort(o))}),t._uU(19,"Project No."),t.qZA(),t.TgZ(20,"th",41),t.NdJ("sort",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onSort(o))}),t._uU(21,"Owner"),t.qZA(),t.TgZ(22,"th",42),t.NdJ("sort",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onSort(o))}),t._uU(23,"Test Run No."),t.qZA(),t.TgZ(24,"th",43),t.NdJ("sort",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onSort(o))}),t._uU(25,"Start Time"),t.qZA(),t.TgZ(26,"th",44),t.NdJ("sort",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onSort(o))}),t._uU(27,"End Time"),t.qZA(),t.TgZ(28,"th",45),t.NdJ("sort",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onSort(o))}),t._uU(29,"Total Run Time"),t.qZA()()(),t.TgZ(30,"tbody"),t.YNc(31,N,23,21,"tr",46),t.qZA()(),t.TgZ(32,"div",47)(33,"span"),t._uU(34),t.qZA(),t.TgZ(35,"ngb-pagination",48),t.NdJ("pageChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.handlePageChange(o))})("pageChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.page=o)}),t.qZA()()()()()}if(2&r){const e=t.oxw();t.xp6(1),t.Q6J("hidHeader",!0)("options",!1),t.xp6(30),t.Q6J("ngForOf",e.selectedTableData),t.xp6(3),t.AsE("Page ",(e.page-1)*e.pageSize+1," - ",e.page*e.pageSize>e.tableData.length?e.tableData.length:e.page*e.pageSize," "),t.xp6(1),t.Q6J("pageSize",e.pageSize)("collectionSize",null==e.tableData?null:e.tableData.length)("page",e.page)}}function J(r,h){if(1&r&&(t.TgZ(0,"th"),t._uU(1),t.qZA()),2&r){const e=h.$implicit,n=t.oxw(2);t.xp6(1),t.Oqu(n.headerColumns[e])}}function U(r,h){if(1&r&&(t.ynx(0),t._uU(1),t.ALo(2,"date"),t.BQk()),2&r){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,n[e],"dd/MM/yyyy HH:mm:ss")," ")}}function O(r,h){if(1&r&&(t.ynx(0),t._uU(1),t.BQk()),2&r){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n[e]," ")}}function F(r,h){if(1&r&&(t.TgZ(0,"td"),t.YNc(1,U,3,4,"ng-container",25),t.YNc(2,O,2,1,"ng-container",25),t.qZA()),2&r){const e=h.$implicit;t.xp6(1),t.Q6J("ngIf","DateTime"===e),t.xp6(1),t.Q6J("ngIf","DateTime"!==e)}}function E(r,h){if(1&r&&(t.TgZ(0,"tr"),t.YNc(1,F,3,2,"td",56),t.qZA()),2&r){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.displayedColumns)}}function q(r,h){if(1&r){const e=t.EpF();t.TgZ(0,"div")(1,"app-card",50)(2,"div",51)(3,"div",52),t._UZ(4,"i",53),t.TgZ(5,"input",54),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.tbSearchFilter=o)})("keyup",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.handleSearchChange())}),t.qZA()(),t.TgZ(6,"button",32),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.openModal())}),t._UZ(7,"i",55),t._uU(8," Export "),t.qZA()(),t.TgZ(9,"div",34)(10,"table",35)(11,"thead")(12,"tr"),t.YNc(13,J,2,1,"th",56),t.qZA()(),t.TgZ(14,"tbody"),t.YNc(15,E,2,1,"tr",56),t.qZA()(),t.TgZ(16,"div",47)(17,"ngb-pagination",57),t.NdJ("pageChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.page2=o)})("pageChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.handlePageChange2(o))}),t.qZA()()()()()}if(2&r){const e=t.oxw();t.xp6(1),t.Q6J("hidHeader",!0),t.xp6(4),t.Q6J("ngModel",e.tbSearchFilter),t.xp6(8),t.Q6J("ngForOf",e.displayedColumns),t.xp6(2),t.Q6J("ngForOf",e.selectedAnalysisData),t.xp6(2),t.Q6J("collectionSize",e.analysisData.length)("page",e.page2)("maxSize",5)("rotate",!0)("ellipses",!0)("boundaryLinks",!0)}}const H={asc:"desc",desc:"","":"asc"};let R=(()=>{class r{constructor(){this.appSortable="",this.direction="",this.sort=new t.vpe}rotate(){this.direction=H[this.direction],this.sort.emit({column:this.appSortable,direction:this.direction})}static#t=this.\u0275fac=function(n){return new(n||r)};static#e=this.\u0275dir=t.lG2({type:r,selectors:[["th","appSortable",""]],hostVars:4,hostBindings:function(n,o){1&n&&t.NdJ("click",function(){return o.rotate()}),2&n&&t.ekj("asc","asc"===o.direction)("desc","desc"===o.direction)},inputs:{appSortable:"appSortable",direction:"direction"},outputs:{sort:"sort"},standalone:!0})}return r})(),V=(()=>{class r{constructor(e,n,o,a){this.modalService=e,this.headerService=n,this.projectService=o,this.toastService=a,this.xcldata=[],this.selectedTableData=[],this.tableData=[],this.tempTableData=[],this.page=1,this.page2=1,this.pageSize=5,this.tbSearchFilter="",this.toppings="",this.selectedValues=[],this.dataSet1=[],this.testset=[],this.time=[],this.click=-1,this.analysisData=[],this.selectedAnalysisData=[],this.displayedColumns=[],this.headerColumns=C[3],this.type="all",this.AoodItem=["SelectAll","StrokeCount","FcvSP","FlowGrav","WeightScaleRead","DischargeFlow","StrokeCountRate","DischargePressureSP","InAirPressSP","FcvPos","DischargePressurePV","AoddInAirPressPV","SuctionPressurePV"],this.EoddItem=["SelectAll","MotorKWH","FcvSP","Act_MotorRPM","MotorAMP","MotorKW","FlowGrav","WeightScaleRead","DischargeFlow","Set_MotorRPM","DischargePressureSP","FcvPos","DischargePressurePV","SuctionPressurePV","PumpRPM"],this.All=["SelectAll","StrokeCount","MotorKWH","FcvSP","StrokeCountRate","Act_MotorRPM","InAirPressSP","MotorAMP","MotorKW","FlowGrav","WeightScaleRead","AoddInAirPressPV","DischargeFlow","Set_MotorRPM","DischargePressureSP","FcvPos","DischargePressurePV","SuctionPressurePV","PumpRPM"],this.columnNames=[],this.dropdownOptions=[{display:"Option 1 Display",value:"option1_value"},{display:"Option 2 Display",value:"option2_value"}],this.headerService.setHeaderName("Project Report")}ngOnInit(){this.fromDate=new Date,this.toDate=new Date,this.formatTimeModalDate(),this.columnNames=Object.keys(C[0]),this.testColumns=C[0]}getTestData(){const e=this.jsStartDate,n=this.jsEndDate,o=this.type;let a=[];this.tableData=[],this.selectedTableData=[],this.tempTableData=[],this.analysisData=[],this.selectedAnalysisData=[],this.selectedRow=-1,this.selectedValues&&this.selectedValues.length?e&&n&&o&&this.projectService.getListView(e,n).subscribe(s=>{this.xcldata=s.data,"all"==o?a=s.data:(a=s.data.filter(d=>d.ProjectType.toLowerCase()===o),a.length<=0&&this.toastService.show({template:"No Data Available!!",classname:"bg-danger",delay:3e3})),this.tableData=a,this.tempTableData=a,console.log(this.tableData),this.sliceTableData(this.page)}):this.toastService.show({template:"Please select the columns",classname:"bg-warning",delay:3e3})}exportToCSV(){const e=this.tableData.map(d=>Object.values(d));e.unshift(["Project Id","Project Name","Owner","Project No.","Group","Project Type","Test Run No.","Project Config","Test Bench No","Start Time","End Time","Total Run Time"]);const o=l.P6.aoa_to_sheet(e),a=l.P6.decode_range(o["!ref"]);for(let d=a.s.r;d<=a.e.r;++d)for(let g=a.s.c;g<=a.e.c;++g){const D=l.P6.encode_cell({r:d,c:g});o[D]&&(o[D].s||(o[D].s={}),o[D].s.alignment={horizontal:"center",vertical:"center"})}const s=l.P6.book_new();l.P6.book_append_sheet(s,o,"Sheet1"),l.NC(s,"Report.xlsx")}getAnalysisData(e){this.dataSet1=[],this.time=[],this.testset=this.selectedValues.map(n=>n),this.testset.forEach(n=>{this.dataSet1.push({seriesname:n,data:[]})}),this.projectService.getAnalysisData(e,this.jsStartDate,this.jsEndDate,this.testset).subscribe(n=>{n&&n.length>0&&(this.analysisData=n,this.sliceAnalysisData(this.page2),this.displayedColumns=Object.keys(n[0]),n.forEach(o=>{Object.keys(o).forEach(a=>{const s=this.dataSet1.find(d=>d.seriesname===a);s&&s.data.push({value:o[a]}),"datetime"==a&&this.time.push({label:o.datetime})})}))})}onTypeChange(){"eodd"===this.type?(this.selectedValues=[],this.columnNames=this.EoddItem):"aodd"===this.type?(this.selectedValues=[],this.columnNames=this.AoodItem):"all"==this.type&&(this.selectedValues=[],this.columnNames=Object.keys(C[0]))}handleRowClick(e,n){this.selectedRow=n,this.projectId=e,this.getAnalysisData(e),this.click=e}handlePageChange(e){this.sliceTableData(e)}handlePageChange2(e){this.sliceAnalysisData(e)}handleSearchChange(){this.filterAnalysisData(this.tbSearchFilter)}onColSelectChange(){this.selectedValues.includes(this.toppings)||this.selectedValues.push(this.toppings),"SelectAll"==this.toppings&&(this.selectedValues=this.columnNames)}removeTag(e){this.selectedValues=this.selectedValues.filter(n=>n!==e),"SelectAll"==e&&(this.selectedValues=[])}onSelectionChange(){this.getTestData()}isDisabledColSelect(e){return!!this.selectedValues.includes(e)}openDateTimeModal(){const o={startDate:this.fromDate,endDate:this.toDate},a=this.modalService.open(A.Z);a.componentInstance.inputData=o,a.result.then(s=>{const g=new Intl.DateTimeFormat("en-GB",{hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),D=new Date(s.dateData.startDate.year,s.dateData.startDate.month-1,s.dateData.startDate.day,s.dateData.startTime.hour,s.dateData.startTime.minute,0),v=g.format(D),P=new Date(s.dateData.endDate.year,s.dateData.endDate.month-1,s.dateData.endDate.day,s.dateData.endTime.hour,s.dateData.endTime.minute,0),w=g.format(P);this.formattedDateTimeRange=v+" - "+w,this.jsStartDate=D,this.jsEndDate=P,this.jsStartDate=this.formatDate(this.jsStartDate),this.jsEndDate=this.formatDate(this.jsEndDate)},s=>{console.log(`Modal dismissed with: ${s}`)})}openModal(){const e={projectId:this.projectId,xcldata:this.xcldata,testset:this.testset,fromDate:this.jsStartDate,toDate:this.jsEndDate},n=this.modalService.open(T,{size:"lg"});n.componentInstance.inputData=e,n.result.then(o=>{1==o.isSearch&&console.log(o)},o=>{console.log(`Modal dismissed with: ${JSON.stringify(o)}`)})}onSort({column:e,direction:n}){if(this.headers)for(const o of this.headers)o.appSortable!==e&&(o.direction="");""===n||""===e?(this.tableData=this.tempTableData,this.sliceTableData(this.page)):(this.tableData=[...this.tempTableData].sort((o,a)=>{const s=((r,h)=>r<h?-1:r>h?1:0)(o[e],a[e]);return"asc"===n?s:-s}),this.sliceTableData(this.page))}formatTimeModalDate(){const n=new Intl.DateTimeFormat("en-GB",{hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),a=n.format(this.toDate),s=this.fromDate;s.setMonth(s.getMonth()-1);const d=n.format(s);this.jsStartDate=this.formatDate(this.fromDate),this.jsEndDate=this.formatDate(this.toDate),this.formattedDateTimeRange=d+" - "+a}sliceTableData(e){this.selectedTableData=this.tableData.slice((e-1)*this.pageSize,e*this.pageSize)}sliceAnalysisData(e){this.selectedAnalysisData=this.analysisData.slice((e-1)*this.pageSize,e*this.pageSize)}filterAnalysisData(e){const n=this.analysisData.filter(o=>{if(Object.entries(o).some(d=>{let g=d[1].toString();return e.startsWith("Test Bench")&&"TestBenchNo"==d[0]&&(g="Test Bench "+g),g.toLowerCase().includes(e.toLowerCase())}))return o});this.selectedAnalysisData=n}getCurrentDateTime(){return this.formatDate(new Date)}formatDate(e){return`${e.getFullYear()}-${this.padZero(e.getMonth()+1)}-${this.padZero(e.getDate())}T${this.padZero(e.getHours())}:${this.padZero(Math.abs(e.getMinutes()))}`}padZero(e){return e<10?`0${e}`:`${e}`}static#t=this.\u0275fac=function(n){return new(n||r)(t.Y36(b.FF),t.Y36(u.r),t.Y36(M.Y),t.Y36(x.k))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-project-report"]],viewQuery:function(n,o){if(1&n&&t.Gf(R,5),2&n){let a;t.iGM(a=t.CRH())&&(o.headers=a)}},standalone:!0,features:[t.jDz],decls:35,vars:9,consts:[[1,"project-report"],[1,"col-md-12","parameterTrendView","mt-3"],["cardTitle","Parameter Trend View",3,"options","hidHeader"],[1,"row","d-flex","justify-content-between"],[1,"col-md-5","col-sm-12","d-flex","align-items-start"],[1,"d-flex","justify-content-end","dateRangePicker"],[1,"custom-datetime-range-span",3,"click"],[1,"fas","fa-calendar"],[1,"col-md-2","form-group","col-sm-12"],[1,"form-group","d-flex","gap-2","align-items-center"],["for",""],[1,"form-control",3,"ngModel","ngModelChange","change"],["value","all"],["value","eodd"],["value","aodd"],[1,"col-md-4","col-sm-12"],[1,"form-group"],["value","","disabled","","selected",""],["style","font-weight: bold;",3,"value","disabled",4,"ngFor","ngForOf"],[1,"col-md-1","col-sm-12"],["type","button",1,"btn","btn-primary","p-1","px-3","text-center","btn-apply",2,"font-size","13px",3,"click"],[1,"col-12","col-sm-12","d-flex","align-items-start"],[1,"col-md-12"],[1,"tag-input"],["class","tag",4,"ngFor","ngForOf"],[4,"ngIf"],[2,"font-weight","bold",3,"value","disabled"],[1,"tag"],[1,"remove",3,"click"],[1,"fas","fa-times"],[3,"hidHeader","options"],[1,"export","d-flex","justify-content-end"],[1,"btn","btn-success",3,"click"],[1,"fa","fa-file-csv","fw-bolder"],[1,"table-responsive"],[1,"table","table-styling"],["appSortable","ProjectId",3,"sort"],["appSortable","ProjectName",3,"sort"],["appSortable","TestBenchNo",3,"sort"],["appSortable","ProjectType",3,"sort"],["appSortable","ProjectNo",3,"sort"],["appSortable","ProjectOwner",3,"sort"],["appSortable","TestNo",3,"sort"],["appSortable","StartDateTime",3,"sort"],["appSortable","EndDateTime",3,"sort"],["appSortable","differnce",3,"sort"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-end","align-items-center","gap-3"],[1,"m-0",3,"pageSize","collectionSize","page","pageChange"],[3,"ngClass","click"],[3,"hidHeader"],[1,"export","d-flex","justify-content-between"],[1,"searchbar","col-md-4"],[1,"feather","icon","icon-search"],["type","text","name","","id","","placeholder","Search Project Name, Num, Owner, Type...",3,"ngModel","ngModelChange","keyup"],[1,"fa","fa-file-csv"],[4,"ngFor","ngForOf"],[3,"collectionSize","page","maxSize","rotate","ellipses","boundaryLinks","pageChange"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"app-card",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"span",6),t.NdJ("click",function(){return o.openDateTimeModal()}),t._UZ(7,"i",7),t._uU(8),t.qZA()()(),t.TgZ(9,"div",8)(10,"div",9)(11,"label",10),t._uU(12,"Type"),t.qZA(),t.TgZ(13,"select",11),t.NdJ("ngModelChange",function(s){return o.type=s})("change",function(){return o.onTypeChange()}),t.TgZ(14,"option",12),t._uU(15,"All"),t.qZA(),t.TgZ(16,"option",13),t._uU(17,"EODD"),t.qZA(),t.TgZ(18,"option",14),t._uU(19,"AODD"),t.qZA()()()(),t.TgZ(20,"div",15)(21,"div",16)(22,"select",11),t.NdJ("ngModelChange",function(s){return o.toppings=s})("change",function(){return o.onColSelectChange()}),t.TgZ(23,"option",17),t._uU(24,"Select Column names"),t.qZA(),t.YNc(25,_,2,3,"option",18),t.qZA()()(),t.TgZ(26,"div",19)(27,"button",20),t.NdJ("click",function(){return o.onSelectionChange()}),t._uU(28,"Apply"),t.qZA()()(),t.TgZ(29,"div",21)(30,"div",22)(31,"div",23),t.YNc(32,f,4,1,"div",24),t.qZA()()()()(),t.YNc(33,k,36,8,"div",25),t.YNc(34,q,18,10,"div",25),t.qZA()),2&n&&(t.xp6(2),t.Q6J("options",!1)("hidHeader",!0),t.xp6(6),t.hij(" ",o.formattedDateTimeRange," "),t.xp6(5),t.Q6J("ngModel",o.type),t.xp6(9),t.Q6J("ngModel",o.toppings),t.xp6(3),t.Q6J("ngForOf",o.columnNames),t.xp6(7),t.Q6J("ngForOf",o.selectedValues),t.xp6(1),t.Q6J("ngIf",o.tableData&&o.tableData.length),t.xp6(1),t.Q6J("ngIf",o.analysisData&&o.analysisData.length))},dependencies:[i.ez,i.mk,i.sg,i.O5,i.uU,Z.m,m.YN,m.Kr,m.Fj,m.EJ,m.JJ,m.On,p.A,b.N9,R],styles:[".searchbar{background-color:#ddd;padding:2px 8px;display:flex;align-items:center;border-radius:20px;max-height:26px}  .searchbar .feather{font-size:15px}  .searchbar input{flex:1;background-color:transparent;border:0;outline:0}  .custom-datetime-range-span{padding:2px 8px;border:solid 1px rgb(206,212,218);border-radius:20px}  .custom-datetime-range-span i{margin-right:15px}  .card .card-body{padding:10px 8px!important}  .btn-apply{padding:2px 8px!important;margin-left:5px}  select.form-control{background-color:#e4e4e4!important;line-height:15px}  select.form-control option:disabled{color:#878787}  .tag-input{display:flex;flex-wrap:wrap;align-items:center;margin:0}  .tag{background-color:#6c757d;color:#fff;padding:6px 8px;margin:0 4px;display:flex;align-items:center;border-radius:20px;font-size:10px}  .remove{cursor:pointer;margin-left:4px;font-weight:700}  .selectedRowColor{background-color:#d3d3d3;color:#fff}  .dark{color:#fff!important}  option:disabled{background-color:#eef075}"]})}return r})()},8837:y=>{y.exports=JSON.parse('[{"SelectAll":"Select All","MotorKWH":"Motor Energy","FlowGrav":"Gravimetric Flow","DischargePressurePV":"Discharge Pressure","DischargePressureSP":"Discharge Pressure Setpoint","StrokeCount":"Stroke Count","FcvSP":"Discharge Control Valve","StrokeCountRate":"Stroke Count Rate","Act_MotorRPM":"Actual Motor Speed","InAirPressSP":"In Air Valve Output","MotorAMP":"Motor Current","MotorKW":"Motor Power","WeightScaleRead":"Gravimetric Weight","AoddInAirPressPV":"In Air Pressure ","DischargeFlow":"Discharge Flow","Set_MotorRPM":"Motor Speed Setpoint","FcvPos":"Discharge Control Valve Position","SuctionPressurePV":"Suction Pressure","PumpRPM":"Pump RPM"},0,0,{"MotorKWH":"Motor Energy (kwh)","FlowGrav":"Gravimetric Flow (kG/Min)","DischargePressurePV":"Discharge Pressure (BAR)","DischargePressureSP":"Discharge Pressure Setpoint (BAR)","StrokeCount":"Stroke Count","FcvSP":"Discharge Control Valve O/p (%)","StrokeCountRate":"Stroke Count Rate","Act_MotorRPM":"Actual Motor Speed","InAirPressSP":"In Air Valve Output","MotorAMP":"Motor Current (A)","MotorKW":"Motor Power (kw)","WeightScaleRead":"Gravimetric Weight (Kg)","AoddInAirPressPV":"In Air Pressure ","DischargeFlow":"Discharge Flow (LPM)","Set_MotorRPM":"Motor Speed Setpoint (Hz)","FcvPos":"Discharge Control Valve Position (%)","SuctionPressurePV":"Suction Pressure (BAR)","PumpRPM":"Pump RPM","ProjectId":"Project Id","TestNo":"Test No","DateTime":"Date Time"}]')}}]);